<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Newman ACE Dashboard</title>
    
    <!-- Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (Core Engine) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (Translates code for browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react/dist/umd/lucide-react.min.js"></script>

    <!-- Custom Theme Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        newman: {
                            gold: '#D4AF37', // Approximated Gold
                            maroon: '#660000', // Approximated Maroon
                            dark: '#0f172a',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #020617; color: white; -webkit-tap-highlight-color: transparent; }
        /* Custom scrollbar for gritty feel */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #D4AF37; }
        
        .grit-bg {
            background-image: radial-gradient(circle at center, #1e293b 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.2;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: -1;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div class="grit-bg"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
            Activity, Battery, Moon, Utensils, Smile, Move, ChevronRight, 
            AlertTriangle, ShieldCheck, Flame, Zap, Timer, Dumbbell, 
            HeartPulse, ArrowLeft, Info 
        } = lucideReact;

        // --- DATA & LOGIC ---

        const RECOVERY_PROTOCOL = [
            { category: "Dopamine", task: "Cold Shower (30s-2m)", points: 20 },
            { category: "Oxytocin", task: "Contribution / Help someone", points: 20 },
            { category: "Serotonin", task: "Sunlight (5-15 mins)", points: 20 },
            { category: "Endorphins", task: "Zone 2 or Mobility", points: 20 },
            { category: "Pillars", task: "Sleep 8+ Hours", points: 20 },
        ];

        const WORKOUTS = {
            STRENGTH: {
                title: "Ace Strength",
                focus: "Force Production",
                notes: "RPE 6-8. Leave 2 reps in the tank. Focus on bar speed.",
                exercises: [
                    { name: "Incline DB Bench", sets: "3-5", reps: "3-5", rpe: "6-8", recovery: "Fast & Loose" },
                    { name: "Trap Bar Deadlift", sets: "3-5", reps: "3-5", rpe: "6-8", recovery: "Cyclic Sighing" },
                    { name: "Nordic Curls", sets: "3-5", reps: "3-5", rpe: "6-8", recovery: "90s Rest" },
                    { name: "Landmine Rotations", sets: "3", reps: "8/side", rpe: "6", recovery: "60s" }
                ]
            },
            POWER: {
                title: "Explosive Power",
                focus: "Rate of Force Development",
                notes: "Move weight FAST. If it slows down, stop the set.",
                exercises: [
                    { name: "Power Clean", sets: "3-5", reps: "3-5", rpe: "6-7", recovery: "Fast & Loose" },
                    { name: "Box Jumps", sets: "4", reps: "4", rpe: "Max Effort", recovery: "Full Recovery" },
                    { name: "Med Ball Slams", sets: "3", reps: "6", rpe: "Max Effort", recovery: "60s" }
                ]
            },
            SPEED: {
                title: "Velocity / Speed",
                focus: "Max Velocity",
                notes: "Full recovery between reps. Quality > Quantity.",
                exercises: [
                    { name: "Flying 10s", sets: "4", reps: "1", rpe: "10", recovery: "3 mins walk" },
                    { name: "Split Stance Trap Bar Jump", sets: "3-5", reps: "5", rpe: "Max Power", recovery: "2 mins" },
                    { name: "Pogo Hops", sets: "3", reps: "20s", rpe: "Bounce", recovery: "60s" }
                ]
            },
            ZONE2: {
                title: "Aerobic Base (Zone 2)",
                focus: "Engine Building",
                notes: "Nasal Breathing ONLY. Can hold a conversation.",
                exercises: [
                    { name: "Watt Bike / Rower", sets: "1", reps: "30-45 mins", rpe: "3-4", recovery: "N/A" },
                    { name: "Mobility Flow", sets: "1", reps: "10 mins", rpe: "Relaxed", recovery: "Post-session" }
                ]
            },
            ZONE5: {
                title: "Anaerobic Tolerance",
                focus: "Pain Cave",
                notes: "Dark place. High mental resilience required.",
                exercises: [
                    { name: "Norwegian 4x4", sets: "4", reps: "4 mins", rpe: "9 (90% HR)", recovery: "3 mins active" },
                    { name: "RSA (Sprints)", sets: "6", reps: "35m", rpe: "Max", recovery: "10s between reps" }
                ]
            },
            HYPERTROPHY: {
                title: "Armour Building",
                focus: "Muscle Growth",
                notes: "Control the eccentric. Feel the stretch.",
                exercises: [
                    { name: "Goblet Squats", sets: "3-5", reps: "8-12", rpe: "7-8", recovery: "90s" },
                    { name: "Weighted Dips", sets: "3-5", reps: "8-12", rpe: "8", recovery: "90s" },
                    { name: "Pull Ups", sets: "3-5", reps: "Max-2", rpe: "8", recovery: "90s" }
                ]
            }
        };

        // --- COMPONENTS ---

        const Header = () => (
            <div className="w-full bg-slate-900 border-b border-yellow-600/30 p-4 flex justify-between items-center shadow-lg sticky top-0 z-50 backdrop-blur-md bg-opacity-90">
                <div className="flex items-center gap-3">
                    <div className="w-10 h-10 bg-gradient-to-br from-red-900 to-slate-800 rounded-full border-2 border-yellow-500 flex items-center justify-center font-bold text-yellow-500 text-xs tracking-tighter shadow-lg shadow-yellow-900/20">
                        ACE
                    </div>
                    <div>
                        <h1 className="text-gray-100 font-extrabold tracking-wider text-lg leading-tight">NEWMAN</h1>
                        <p className="text-yellow-600 text-[10px] font-bold tracking-[0.2em] uppercase">Ace Strong 2.0</p>
                    </div>
                </div>
                <div className="flex items-center gap-2">
                    <div className="text-[10px] font-mono text-slate-500 hidden sm:block">SYSTEM ONLINE</div>
                    <div className="h-2 w-2 rounded-full bg-green-500 animate-pulse shadow-[0_0_10px_rgba(34,197,94,0.5)]"></div>
                </div>
            </div>
        );

        const ScoreInput = ({ label, icon: Icon, value, onChange, min = 1, max = 10, desc, color = "text-yellow-500" }) => (
            <div className="bg-slate-800/80 p-4 rounded-xl border border-slate-700/50 shadow-sm mb-3 backdrop-blur-sm">
                <div className="flex justify-between items-center mb-3">
                    <div className={`flex items-center gap-2 ${color}`}>
                        <Icon size={20} />
                        <span className="font-bold text-gray-200 uppercase tracking-wide text-sm">{label}</span>
                    </div>
                    <span className="text-2xl font-black text-white tabular-nums">{value}</span>
                </div>
                <input 
                    type="range" 
                    min={min} 
                    max={max} 
                    value={value} 
                    onChange={(e) => onChange(parseInt(e.target.value))}
                    className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-yellow-500 hover:accent-yellow-400 transition-all"
                />
                <p className="text-xs text-slate-400 mt-2 text-right font-medium">{desc}</p>
            </div>
        );

        const TrafficLight = ({ score }) => {
            let color = "bg-red-600";
            let text = "FULL REST";
            let sub = "System Overload. Respect the biology.";
            let glow = "shadow-red-900/50";
            let ring = "ring-red-500/30";

            if (score >= 7) {
                color = "bg-green-600";
                text = "GREEN LIGHT";
                sub = "System Primed. Attack the session.";
                glow = "shadow-green-900/50";
                ring = "ring-green-500/30";
            } else if (score >= 4) {
                color = "bg-yellow-600";
                text = "AMBER LIGHT";
                sub = "Proceed with caution. Volume reduced.";
                glow = "shadow-yellow-900/50";
                ring = "ring-yellow-500/30";
            }

            return (
                <div className={`w-full py-10 rounded-2xl ${color} ${glow} ring-4 ${ring} shadow-2xl flex flex-col items-center justify-center text-center mb-6 transition-all duration-500 relative overflow-hidden group`}>
                    <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10 mix-blend-overlay"></div>
                    <h2 className="text-4xl sm:text-5xl font-black text-white tracking-tighter uppercase italic relative z-10 drop-shadow-md">{text}</h2>
                    <p className="text-white/90 font-medium mt-2 text-sm px-4 relative z-10">{sub}</p>
                    <div className="mt-6 bg-black/30 px-6 py-2 rounded-full text-white font-mono text-sm border border-white/10 backdrop-blur-md relative z-10">
                        READINESS SCORE: {score.toFixed(1)}
                    </div>
                </div>
            );
        };

        function App() {
            const [step, setStep] = useState('readiness'); 
            const [inputs, setInputs] = useState({
                co2: 25, 
                sleep: 5,
                diet: 5,
                happiness: 5,
                movement: 5
            });
            const [score, setScore] = useState(0);
            const [selectedGoal, setSelectedGoal] = useState(null);

            // Scroll to top on step change
            useEffect(() => {
                window.scrollTo(0, 0);
            }, [step]);

            const calculateScore = () => {
                const co2Score = Math.min(10, Math.max(1, (inputs.co2 / 40) * 10));
                const total = (co2Score + inputs.sleep + inputs.diet + inputs.happiness + inputs.movement) / 5;
                setScore(total);
                setStep('dashboard');
            };

            const selectGoal = (goal) => {
                setSelectedGoal(goal);
                setStep('workout');
            };

            // --- VIEWS ---

            const ReadinessView = () => (
                <div className="p-4 max-w-md mx-auto pb-24 animate-in fade-in duration-500">
                    <div className="mb-6 mt-2">
                        <h2 className="text-3xl font-black text-white mb-1 italic uppercase tracking-tighter">Morning Check-In</h2>
                        <p className="text-slate-400 text-sm font-medium">Calibrate your biological load.</p>
                    </div>

                    <div className="space-y-4">
                        <ScoreInput 
                            label="CO2 Tolerance" 
                            icon={Timer} 
                            value={inputs.co2} 
                            min={10} max={60} 
                            desc="Exhale hold time (seconds)"
                            onChange={(v) => setInputs({...inputs, co2: v})}
                            color="text-blue-400"
                        />
                        <ScoreInput 
                            label="Dr. Quiet (Sleep)" 
                            icon={Moon} 
                            value={inputs.sleep} 
                            desc="Quality & Quantity (1-10)"
                            onChange={(v) => setInputs({...inputs, sleep: v})}
                            color="text-indigo-400"
                        />
                        <ScoreInput 
                            label="Dr. Diet (Fuel)" 
                            icon={Utensils} 
                            value={inputs.diet} 
                            desc="Hydration & Gut Health (1-10)"
                            onChange={(v) => setInputs({...inputs, diet: v})}
                            color="text-green-400"
                        />
                        <ScoreInput 
                            label="Dr. Happiness" 
                            icon={Smile} 
                            value={inputs.happiness} 
                            desc="Stress & Drive (1-10)"
                            onChange={(v) => setInputs({...inputs, happiness: v})}
                            color="text-yellow-400"
                        />
                        <ScoreInput 
                            label="Dr. Movement" 
                            icon={Move} 
                            value={inputs.movement} 
                            desc="Soreness & aches (10 = Fresh)"
                            onChange={(v) => setInputs({...inputs, movement: v})}
                            color="text-orange-400"
                        />
                    </div>

                    <button 
                        onClick={calculateScore}
                        className="w-full bg-yellow-600 hover:bg-yellow-500 active:bg-yellow-700 text-white font-black py-4 rounded-xl shadow-lg shadow-yellow-900/20 flex items-center justify-center gap-2 transition-all mt-6 text-lg tracking-wide uppercase"
                    >
                        Analyze System <ChevronRight strokeWidth={3} />
                    </button>
                    
                    <p className="text-center text-slate-600 text-xs mt-6">Newman Rugby Academy â€¢ Anti-Fragile System</p>
                </div>
            );

            const DashboardView = () => (
                <div className="p-4 max-w-md mx-auto pb-24 animate-in slide-in-from-right-10 duration-500">
                    <TrafficLight score={score} />

                    {score < 4 ? (
                        <div className="bg-red-950/40 border-l-4 border-red-500 p-5 rounded-r-xl mb-6 shadow-lg backdrop-blur-md">
                            <div className="flex items-start gap-4">
                                <AlertTriangle className="text-red-500 shrink-0 mt-1" size={24} />
                                <div>
                                    <h3 className="text-red-400 font-bold text-lg">CRITICAL WARNING</h3>
                                    <p className="text-red-100/70 text-sm mt-1 leading-relaxed">
                                        Biological markers indicate high system stress. Training today carries high injury risk. 
                                        <br/><br/>
                                        Mandatory Action: <strong>Recovery Protocol Only.</strong>
                                    </p>
                                </div>
                            </div>
                            <button 
                                onClick={() => selectGoal('RECOVERY')}
                                className="w-full mt-5 bg-red-600 hover:bg-red-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-red-900/30 transition-all uppercase tracking-wider text-sm"
                            >
                                Open Recovery Protocol
                            </button>
                        </div>
                    ) : (
                        <>
                            <div className="flex items-center gap-2 mb-4">
                                <div className="h-4 w-1 bg-yellow-500 rounded-full"></div>
                                <h3 className="text-slate-300 font-bold uppercase tracking-widest text-xs">Select Objective</h3>
                            </div>
                            
                            <div className="grid grid-cols-2 gap-3">
                                {[
                                    { id: 'STRENGTH', icon: Dumbbell, color: 'text-yellow-500', label: 'Strength' },
                                    { id: 'POWER', icon: Zap, color: 'text-yellow-500', label: 'Power' },
                                    { id: 'SPEED', icon: Flame, color: 'text-orange-500', label: 'Speed' },
                                    { id: 'ZONE5', icon: Activity, color: 'text-red-500', label: 'Zone 5' },
                                    { id: 'HYPERTROPHY', textIcon: 'H', color: 'text-blue-500', label: 'Hypertrophy' },
                                    { id: 'ZONE2', icon: HeartPulse, color: 'text-green-500', label: 'Zone 2' },
                                ].map((btn) => (
                                    <button 
                                        key={btn.id}
                                        onClick={() => selectGoal(btn.id)} 
                                        className="bg-slate-800/80 hover:bg-slate-700 active:scale-95 p-5 rounded-xl border border-slate-700/50 flex flex-col items-center gap-3 transition-all shadow-lg group relative overflow-hidden"
                                    >
                                        <div className="absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        {btn.icon ? <btn.icon className={btn.color} size={32} /> : <div className={`${btn.color} font-black text-2xl`}>{btn.textIcon}</div>}
                                        <span className="text-white font-bold text-sm tracking-wider">{btn.label.toUpperCase()}</span>
                                    </button>
                                ))}
                            </div>
                            
                            <div className="mt-6 border-t border-slate-800 pt-6">
                                <button onClick={() => selectGoal('RECOVERY')} className="w-full bg-slate-800/50 hover:bg-slate-800 p-4 rounded-xl border border-slate-700 flex items-center justify-center gap-3 transition-all group">
                                    <ShieldCheck className="text-blue-400 group-hover:scale-110 transition-transform" />
                                    <span className="text-blue-100 font-bold">Active Recovery / Mobility</span>
                                </button>
                            </div>
                        </>
                    )}
                </div>
            );

            const WorkoutView = () => {
                if (selectedGoal === 'RECOVERY') {
                    return (
                        <div className="p-4 max-w-md mx-auto pb-24 animate-in slide-in-from-right-10 duration-500">
                            <button onClick={() => setStep('dashboard')} className="text-slate-400 flex items-center gap-2 mb-6 hover:text-white transition-colors pl-1"><ArrowLeft size={16}/> Back to Dashboard</button>
                            
                            <div className="bg-gradient-to-br from-blue-900/40 to-slate-900 border border-blue-500/30 p-6 rounded-2xl mb-6 shadow-xl relative overflow-hidden">
                                <div className="absolute top-0 right-0 p-8 opacity-10 pointer-events-none">
                                    <ShieldCheck size={120} className="text-blue-400" />
                                </div>
                                <h2 className="text-2xl font-black text-white uppercase italic tracking-tighter relative z-10">100 Pt Recovery</h2>
                                <p className="text-blue-200 mt-2 text-sm font-medium relative z-10">Clear system debt. Aim for 100 points.</p>
                            </div>

                            <div className="space-y-3">
                                {RECOVERY_PROTOCOL.map((item, idx) => (
                                    <div key={idx} className="bg-slate-800/80 backdrop-blur-sm p-4 rounded-xl flex justify-between items-center border border-slate-700/50 shadow-md">
                                        <div>
                                            <div className="text-[10px] text-blue-400 uppercase font-bold tracking-widest mb-1">{item.category}</div>
                                            <div className="text-white font-bold text-sm">{item.task}</div>
                                        </div>
                                        <div className="bg-blue-600/20 border border-blue-500/30 text-blue-200 font-black px-3 py-1 rounded text-xs">
                                            +{item.points}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )
                }

                const plan = WORKOUTS[selectedGoal];
                
                // Auto-regulation Logic
                let volumeModifier = 1;
                let isAmber = false;
                if (score < 7 && score >= 4) {
                    volumeModifier = 0.6; // Cut volume by 40%
                    isAmber = true;
                }

                return (
                    <div className="p-4 max-w-md mx-auto pb-24 animate-in slide-in-from-right-10 duration-500">
                        <button onClick={() => setStep('dashboard')} className="text-slate-400 flex items-center gap-2 mb-6 hover:text-white transition-colors pl-1"><ArrowLeft size={16}/> Back to Dashboard</button>
                        
                        <div className="bg-gradient-to-r from-slate-800 to-slate-900 border-l-4 border-yellow-500 p-6 rounded-r-xl shadow-lg mb-6 relative overflow-hidden">
                            <div className="absolute -right-4 -top-4 opacity-5 rotate-12">
                                <h1 className="text-9xl font-black text-white">ACE</h1>
                            </div>
                            <h2 className="text-3xl font-black text-white uppercase italic tracking-tighter relative z-10">{plan.title}</h2>
                            <div className="flex flex-wrap items-center gap-2 mt-3 relative z-10">
                                <span className="bg-yellow-600/20 text-yellow-500 border border-yellow-600/30 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider">{plan.focus}</span>
                                {isAmber && <span className="bg-orange-600/20 text-orange-400 border border-orange-600/30 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider flex items-center gap-1"><AlertTriangle size={10} /> Adjusted Load</span>}
                            </div>
                            <p className="text-slate-300 mt-4 text-xs font-medium border-t border-slate-700/50 pt-3 italic relative z-10">
                                "{plan.notes}"
                            </p>
                        </div>

                        {isAmber && (
                            <div className="mb-6 bg-orange-950/30 text-orange-200 p-4 rounded-xl text-sm flex items-start gap-3 border border-orange-500/30 shadow-inner">
                                <AlertTriangle size={18} className="shrink-0 mt-0.5" />
                                <span className="font-medium">Readiness is suboptimal (Amber). Volume has been auto-regulated to protect your CNS.</span>
                            </div>
                        )}

                        <div className="space-y-4">
                            {plan.exercises.map((ex, idx) => (
                                <div key={idx} className="bg-slate-800/80 backdrop-blur-sm rounded-xl overflow-hidden border border-slate-700/50 shadow-lg">
                                    <div className="bg-slate-900/50 p-4 border-b border-slate-700/50 flex justify-between items-center">
                                        <h3 className="font-bold text-white text-lg">{ex.name}</h3>
                                        <div className="text-[10px] text-slate-500 uppercase font-black tracking-widest bg-slate-800 px-2 py-1 rounded border border-slate-700">Ex {idx + 1}</div>
                                    </div>
                                    <div className="p-4 grid grid-cols-3 gap-4 text-center relative">
                                        <div className="flex flex-col items-center justify-center border-r border-slate-700/50">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider mb-1">Sets</div>
                                            <div className={`text-xl font-black ${isAmber ? 'text-orange-400' : 'text-yellow-500'}`}>
                                                {/* Rudimentary string parsing to adjust volume if Amber */}
                                                {volumeModifier < 1 && !isNaN(parseInt(ex.sets)) ? Math.ceil(parseInt(ex.sets) * volumeModifier) : ex.sets}
                                            </div>
                                        </div>
                                        <div className="flex flex-col items-center justify-center border-r border-slate-700/50">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider mb-1">Reps</div>
                                            <div className="text-xl font-black text-white">{ex.reps}</div>
                                        </div>
                                        <div className="flex flex-col items-center justify-center">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider mb-1">RPE</div>
                                            <div className="text-xl font-black text-white">{ex.rpe}</div>
                                        </div>
                                    </div>
                                    <div className="px-4 pb-4 pt-0">
                                        <div className="bg-black/30 rounded-lg p-3 flex justify-between items-center border border-white/5">
                                            <span className="text-xs text-slate-400 font-medium">Recovery:</span>
                                            <span className="text-xs text-green-400 font-bold font-mono uppercase tracking-wide">{ex.recovery}</span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen font-sans selection:bg-yellow-500 selection:text-black">
                    <Header />
                    <div className="pt-2">
                        {step === 'readiness' && <ReadinessView />}
                        {step === 'dashboard' && <DashboardView />}
                        {step === 'workout' && <WorkoutView />}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
